global
    # Specify global settings here

defaults
    timeout client 30s
    timeout connect 30s
    timeout server 30s

frontend http_front
    bind *:9090
    mode http

    # Define ACL to match the route path /clientes/1/transacoes
    acl clientes_transacoes path reg ^/clientes/[0-9]+/transacoes

    # Extract the ID "1" from the path and use it for session stickiness
    http-request replace-path /clientes/([0-9]+)/transacoes(.*) /transacoes\2
    use_backend clientes_transacoes_backend if clientes_transacoes

backend clientes_transacoes_backend
    mode http

    # Stick sessions based on the extracted ID
    stick-table type string len 32 size 100k
    stick store-request path

    # Define backend server(s) for handling requests
    server backend1 web01:8080 # Replace with your server IP and port
    server backend2 web02:8080 # Replace with your server IP and port
    # Add more servers if needed
